import socket
import struct

host='<broadcast>'
port=5556

addr_ba = (host, port)

s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
s.setsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR,1)
s.setsockopt(socket.SOL_SOCKET,socket.SO_BROADCAST,1)
s.bind(('',port))

def print_hex(data):
    for d in data:
        print '%02x' % struct.unpack('B', d),
    print
    return

def hex2bin(data):
    data_bin_array=''
    for d in data:
        data_bin_array = data_bin_array + struct.pack('B', d)
    return data_bin_array


data_resp1 = hex2bin([0x1b, 0x2a, 0x56, 0x5f, 0x00, 0xc0, 0xa8, 0x02, 0x1c, 0xc0, 0xa8, 0x02, 0x08, 0x00, 0x00, 0x00, 0x00, 0x53, 0x74, 0x61, 0x6e, 0x64, 0x61, 0x72, 0x64, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x53, 0x57, 0x49, 0x54, 0x43, 0x48, 0x5f, 0x30, 0x31, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4d, 0x41, 0x54, 0x58, 0x30, 0x38, 0x30, 0x63, 0x20, 0x43, 0x50, 0x55, 0x20, 0x31, 0x20, 0x46, 0x30, 0x33, 0x2e, 0x30, 0x31, 0x20, 0x32, 0x39, 0x2e, 0x30, 0x33, 0x2e, 0x31, 0x36, 0x00, 0x00, 0x00, 0x21, 0x5f, 0x02, 0x07, 0x9c])

while 1:
    try:
        data,addr=s.recvfrom(8192)
        print "got data from",addr
        #print_hex(data)
        cmd_p2 = struct.unpack('B', data[2])
        if 0x55 == cmd_p2[0]:
            s.sendto(data_resp1, addr_ba)
        #    print(data)
    except KeyboardInterrupt:
        raise
